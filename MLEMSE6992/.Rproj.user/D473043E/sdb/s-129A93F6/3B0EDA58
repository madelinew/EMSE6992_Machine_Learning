{
    "collab_server" : "",
    "contents" : "library(readxl)\nFARS2015 <- read_excel(\"~/Documents/EMSE 6992 ML/Final Project/Data/FARS2015.xls\", \n                       col_types = c(\"numeric\", \"numeric\", \"numeric\", \n                                     \"numeric\", \"numeric\", \"numeric\", \n                                     \"numeric\", \"numeric\", \"numeric\", \n                                     \"numeric\", \"numeric\", \"numeric\", \"text\"))\n\nFARS_15new <- as.data.frame(FARS2015, header = TRUE, as.is=TRUE)\n\n\nFARS2016 <- read_excel(\"~/Documents/EMSE 6992 ML/Final Project/Data/FARS2016.xls\", \n                       col_types = c(\"numeric\", \"numeric\", \"numeric\", \n                                     \"numeric\", \"numeric\", \"numeric\", \n                                     \"numeric\", \"numeric\", \"numeric\", \n                                     \"numeric\", \"numeric\", \"numeric\", \"text\"))\n\nFARS_16new <- as.data.frame(FARS2016, header = TRUE, as.is=TRUE)\n\n\nlibrary(\"stringr\", lib.loc=\"/Library/Frameworks/R.framework/Versions/3.2/Resources/library\")\nlibrary(\"plyr\", lib.loc=\"/Library/Frameworks/R.framework/Versions/3.2/Resources/library\")\nlibrary(\"knitr\", lib.loc=\"/Library/Frameworks/R.framework/Versions/3.2/Resources/library\")\nlibrary(\"gridExtra\", lib.loc=\"/Library/Frameworks/R.framework/Versions/3.2/Resources/library\")\nlibrary(\"png\", lib.loc=\"/Library/Frameworks/R.framework/Versions/3.2/Resources/library\")\nlibrary(\"pander\", lib.loc=\"/Library/Frameworks/R.framework/Versions/3.2/Resources/library\")\nlibrary(\"dplyr\", lib.loc=\"/Library/Frameworks/R.framework/Versions/3.2/Resources/library\")\nlibrary(\"tidyr\", lib.loc=\"/Library/Frameworks/R.framework/Versions/3.2/Resources/library\")\n\nfatal_YYsetup <- function(df, YYYY) {\n  #df = FARS_YY\n  #YYYY = case year\n  y = YYYY\n  \n  fatal <- as.data.frame(cbind.data.frame(df$casenum, df$statenum, df$vnumber, df$accday, df$accmon,\n                                          df$caseyear, df$landuse, df$age, df$vfatcount, df$numoccs,\n                                          df$modelyr, df$dridistract), \n                           header = TRUE, as.is = TRUE, stringsAsFactor=FALSE)\n \n  colnames(fatal) <- c(\"casenum\", \"statenum\", \"vehnum\",\"day\", \"month\", \"year\", \"landuse\", \"age\",\n                         \"vfatcount\", \"numoccs\", \"modelyr\", \"dridistract\")\n  \n  #Fixing age as num\n  fatal$age <- as.integer(fatal$age)\n  fatal <- unique(fatal)\n  #removes error coded ages\n  fatal <- fatal[fatal$age < 997,]\n  \n  return(fatal)\n}\n\n## STORE RESULT OF FUNCTION IN MAIN DATA FRAME ##\n#INPUT EXAMPLE:   fatal_16 <- fatal_YYsetup(FARS_16, 2016) #\n#fatal_16na <- fatal_YYnasetup(FARS_16, 2016)\nfatal_15t <- fatal_YYsetup(FARS_15new, 2015)\nfatal_16t <- fatal_YYsetup(FARS_16new, 2016)\n\nseparatingDriDistract <- function(df) {\n  ndf <- df\n  ndf <- ndf %>% separate(dridistract, c(\"dridistract1\", \"dridistract2\", \"dridistract3\"), \", \", extra = \"warn\", fill = \"right\")\n  ndf$dridistract1 <- as.integer(ndf$dridistract1)\n  ndf[is.na(ndf)] <- 0\n  ndf$dridistract2 <- as.integer(ndf$dridistract2)\n  ndf$dridistract3 <- as.integer(ndf$dridistract3)\n  return(ndf)\n}\nfatal_15final <- separatingDriDistract(fatal_15t)\nfatal_16final <- separatingDriDistract(fatal_16t)\n\n\n\nfindingCellCases <- function(df, YY) {\n  #df = fatal_YY\n  #YY = case year\n  setupfataldis <- function(df) {\n    setupdrf <- function(df){\n      #5 = Talking or listening to cell phone\n      #6 = While dialing Cell phone\n      #15 = Other cell phone distraction\n      df$cellphoneuse <- ifelse(df$dridistract1 == 5, 1,\n                                ifelse(df$dridistract2 == 5, 1,\n                                       ifelse(df$dridistract3 == 5, 1,\n                                              ifelse(df$dridistract1 == 6, 1,\n                                                     ifelse(df$dridistract2 == 6, 1,\n                                                            ifelse(df$dridistract3 == 6, 1,\n                                                                   ifelse(df$dridistract1 == 15, 1,\n                                                                          ifelse(df$dridistract2 == 15, 1,\n                                                                                 ifelse(df$dridistract3 == 15, 1, 0)))))))))\n      drop <- c(\"dridistract1\", \"dridistract2\",\"dridistract3\")\n      df = df[,!(names(df) %in% drop)]\n      return(df)\n    }\n    fataldisYY <- setupdrf(df)\n    return(fataldisYY)\n  }\n  fataldisYY <- setupfataldis(df)\n  return(fataldisYY)\n}\n\n\n\nfatal_15dsfinal <- findingCellCases(fatal_15final, 15)\nfatal_16dsfinal <- findingCellCases(fatal_16final, 16)\n\n\n\nfulldataset <- rbind(fatal_15dsfinal, fatal_16dsfinal)\n\n\n\ntableToCSV <- function(df) {\n  #df = fulldata\n  row.names(df)<- NULL\n  colnames(df) <- c(\"casenum\", \"statenum\", \"vehnum\",\"day\", \"month\", \"year\", \"landuse\", \"age\",\n                    \"vfatcount\", \"numoccs\", \"modelyr\", \"cellphone_use\")\n  write.csv(df, file = \"fulldataset1516.csv\")\n}\ntableToCSV(fulldataset)\n",
    "created" : 1554216345416.000,
    "dirty" : true,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2629689688",
    "id" : "3B0EDA58",
    "lastKnownWriteTime" : 1556471933,
    "last_content_update" : 1556482342327,
    "path" : "~/Documents/EMSE 6992 ML/Final Project/MLEMSE6992/MMW_Final_Project_Cleaning.R",
    "project_path" : "MMW_Final_Project_Cleaning.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 8,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}